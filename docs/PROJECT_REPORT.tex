%%
%% 12-Lead ECG Reconstruction from Reduced Lead Sets
%% DATA 5000 Final Project Report
%% Team 4: Damilola Olaiya & Mithun Manivannan
%%
%% Based on ACM sigconf template
%%
\documentclass[sigconf]{acmart}

%% Rights management - for class project
\setcopyright{none}
\acmConference[DATA 5000]{Data Science Capstone Project}{December 2025}{Carleton University, Ottawa, Canada}
\acmYear{2025}

%% Remove ACM-specific elements for class project
\settopmatter{printacmref=false}
\renewcommand\footnotetextcopyrightpermission[1]{}
\pagestyle{plain}

%% Additional packages
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{tabularx}
\usepackage{ragged2e}
\usepackage{array}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    citecolor=teal,
    urlcolor=magenta,
    filecolor=cyan,
    pdfborder={0 0 0}
}
\sloppy

\newcommand{\maybeincludegraphics}[2][]{%
    \IfFileExists{#2}{\includegraphics[#1]{#2}}{%
        \fbox{\begin{minipage}[c][3cm][c]{0.95\linewidth}\centering\small\textit{Figure not available: #2}\end{minipage}}%
    }%
}

\graphicspath{{figures/}}

%%
%% Title
%%
\title{12-Lead ECG Reconstruction from Reduced Lead Sets: A Hybrid Physics-Informed Deep Learning Approach}

%%
%% Authors
%%
\author{Damilola Olaiya}
\email{damilolaolaiya@cmail.carleton.ca}
\affiliation{%
  \institution{Carleton University}
  \city{Ottawa}
  \state{Ontario}
  \country{Canada}
}

\author{Mithun Manivannan}
\email{mithun.manivannan@cmail.carleton.ca}
\affiliation{%
  \institution{Carleton University}
  \city{Ottawa}
  \state{Ontario}
  \country{Canada}
}

\renewcommand{\shortauthors}{Olaiya \& Manivannan}

%%
%% Abstract
%%
\begin{abstract}
Cardiovascular disease (CVD) remains the world's leading cause of death, yet the gold-standard 12-lead electrocardiogram (ECG) is difficult to deploy outside clinical environments due to equipment complexity and technician requirements. We study a hybrid, physics-informed deep learning approach to reconstruct the full 12-lead ECG from only three measured leads (I, II, V4). Deterministic physiological relationships---Einthoven's law and Goldberger's equations---enable exact, zero-parameter reconstruction of four limb leads (III, aVR, aVL, aVF), while a 1D U-Net reconstructs the remaining five precordial leads (V1, V2, V3, V5, V6). On PTB-XL with patient-wise splits to avoid data leakage, the learned chest leads achieve mean correlation $r \approx 0.846$ in a final single-run model, with per-lead performance V1=0.818, V2=0.827, V3=0.860, V5=0.891, V6=0.836. A preliminary ablation indicates that a shared decoder (17.1M parameters) outperforms a larger lead-specific decoder (40.8M parameters), suggesting parameter sharing acts as regularization under limited input information. Analysis of inter-lead correlations shows that reconstruction quality closely follows the anatomical and statistical proximity of target leads to the measured input lead V4, indicating that input lead choice is a more important design knob than architectural complexity. Code and artifacts are publicly available.
\end{abstract}

%%
%% CCS Concepts
%%
\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10010147.10010178.10010179</concept_id>
       <concept_desc>Computing methodologies~Machine learning</concept_desc>
       <concept_significance>500</concept_significance>
   </concept>
   <concept>
       <concept_id>10010147.10010178.10010179.10010182</concept_id>
       <concept_desc>Computing methodologies~Neural networks</concept_desc>
       <concept_significance>500</concept_significance>
   </concept>
   <concept>
       <concept_id>10003120.10003121.10003129</concept_id>
       <concept_desc>Human-centered computing~Ubiquitous and mobile computing</concept_desc>
       <concept_significance>300</concept_significance>
   </concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computing methodologies~Machine learning}
\ccsdesc[500]{Computing methodologies~Neural networks}
\ccsdesc[300]{Human-centered computing~Ubiquitous and mobile computing}

%%
%% Keywords
%%
\keywords{ECG reconstruction, deep learning, U-Net, neural networks, cardiovascular disease, reduced lead ECG, wearable health monitoring}

\begin{document}
\maketitle

%% ============================================================================
%% INTRODUCTION
%% ============================================================================

\section{Introduction}
Cardiovascular diseases (CVDs) are the leading cause of mortality worldwide, responsible for an estimated 17.9 million deaths annually. CVDs are particularly dangerous because conditions such as hypertension, atherosclerosis, and early-stage heart failure may remain asymptomatic for years until a major event occurs.

The electrocardiogram (ECG) is the standard non-invasive tool for cardiac assessment, capturing the heart's electrical activity through multiple projections to support detection of arrhythmias, myocardial infarction, conduction abnormalities, and ventricular hypertrophy~\cite{ref42}. The standard 12-lead ECG comprises six limb leads (I, II, III, aVR, aVL, aVF) and six chest leads (V1--V6), providing complementary views from frontal and horizontal planes.

In practice, 12-lead acquisition is constrained by the need for ten electrodes, careful anatomical placement, and trained operators~\cite{ref30}. This limits its use in ambulances, primary care, homes, and resource-constrained settings~\cite{ref43}, while consumer wearables typically record only 1--2 leads~\cite{ref45,ref48}. This gap between what is clinically desirable and what is practically deployable motivates reconstruction of missing leads from reduced-lead recordings.

We investigate a hybrid approach that combines deterministic physiology-based derivations for limb leads with a deep neural network for chest lead reconstruction, using only three measured leads (I, II, V4).

\subsection{Contributions}
We focus on the following contributions:
\begin{itemize}
    \item A hybrid architecture that uses closed-form physiological relationships for limb leads and a 1D U-Net for precordial leads, reducing the learning problem to five chest leads.
    \item A patient-wise evaluation protocol on PTB-XL to avoid data leakage and provide more realistic estimates of generalization.
    \item Empirical analysis showing that reconstruction performance is primarily limited by inter-lead correlations, not architectural complexity, and that a shared decoder outperforms a larger lead-specific decoder.
    \item Feature- and diagnostic-level evaluation indicating which downstream tasks can be safely supported by reconstructed leads and which require caution.
\end{itemize}

%% ============================================================================
%% BACKGROUND
%% ============================================================================

\section{Background}
\subsection{ECG Lead System}
A \emph{lead} is a voltage difference between electrodes that yields a particular projection of the cardiac electrical field. Each lead is therefore a view of the same event from a different angle. Figure~\ref{fig:sample_ecg} illustrates a typical 12-lead ECG.

\begin{figure*}[t]
\centering
\maybeincludegraphics[width=0.8\textwidth]{figures/sample_ecg.png}
\Description{Example 12-lead ECG recording from PTB-XL showing all standard limb and chest leads.}
\caption{Example 12-lead ECG recording (PTB-XL sample).}
\label{fig:sample_ecg}
\end{figure*}

\subsubsection{Limb Leads (Frontal Plane)}
The six limb leads describe electrical activity in the frontal plane.

\textbf{Bipolar Leads (I, II, III):}
\begin{align}
    \text{Lead I} &= V_{LA} - V_{RA} \\
    \text{Lead II} &= V_{LL} - V_{RA} \\
    \text{Lead III} &= V_{LL} - V_{LA}
\end{align}

\textbf{Einthoven's Law:}
\begin{equation}
    \text{Lead III} = \text{Lead II} - \text{Lead I}
    \label{eq:einthoven}
\end{equation}

\textbf{Augmented Leads (aVR, aVL, aVF):}
\begin{align}
    \text{aVR} &= -\frac{\text{Lead I} + \text{Lead II}}{2} \label{eq:avr}\\
    \text{aVL} &= \text{Lead I} - \frac{\text{Lead II}}{2} \label{eq:avl}\\
    \text{aVF} &= \text{Lead II} - \frac{\text{Lead I}}{2} \label{eq:avf}
\end{align}

Given Leads I and II, all remaining limb leads can thus be computed exactly~\cite{ref33}.

\subsubsection{Chest Leads (Horizontal Plane)}
The six precordial leads (V1--V6) are placed on the chest and reflect local ventricular activation. Unlike limb leads, they cannot be derived from simple algebraic relationships and must be either measured directly or inferred from other leads.

\begin{table}[h]
\caption{Precordial lead positions and anatomical views}
\label{tab:chest_leads}
\begin{tabular}{lll}
\toprule
Lead & Position & View \\ \midrule
V1 & 4th ICS, right of sternum & Right ventricle \\
V2 & 4th ICS, left of sternum & Septal region \\
V3 & Between V2 and V4 & Anterior wall \\
V4 & 5th ICS, midclavicular & Anterior wall \\
V5 & Level with V4, anterior axillary & Lateral wall \\
V6 & Level with V4, midaxillary & Left lateral wall \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Clinical Significance of Missing Leads}
Different regions of myocardium manifest in distinct leads~\cite{ref35,ref38}. Anterior infarction is primarily visible in V1--V4, bundle branch blocks alter QRS morphology in V1 and V6, and left ventricular hypertrophy affects voltages across several chest leads~\cite{ref52}. Limb-lead-only devices can therefore miss clinically important patterns, motivating accurate reconstruction of precordial leads from reduced-lead systems.

%% ============================================================================%%
%% RELATED WORK
%% ============================================================================

\section{Related Work}
ECG reconstruction has progressed from linear transforms to modern deep and generative models over the last four decades~\cite{ref65}.

\subsection{Classical and Adaptive Methods}
Classical approaches used lead systems such as Frank~\cite{ref33}, Dower~\cite{ref34}, and EASI~\cite{ref39}, where fixed coefficient matrices project a small number of measured leads into the 12-lead space. These methods are efficient and interpretable but degrade under non-standard anatomy and pathological morphologies~\cite{ref25}.

Adaptive approaches based on wavelets, adaptive filters, and compressive sensing~\cite{ref1,ref15,ref19,ref20} introduced some personalization, but required manual feature engineering and were sensitive to ambulatory noise.

\subsection{Deep Learning and Generative Models}
Convolutional and recurrent networks have been applied directly to ECG reconstruction, showing that deep models can learn non-linear mappings from reduced lead sets to full 12-lead signals~\cite{ref5,ref17}. More recent work explores foundation models trained with self-supervised objectives on large ECG corpora~\cite{ref61,ref64} and generative models such as VAEs, diffusion models, and state-space models~\cite{ref58,ref59,ref60}, which focus mainly on synthesis and representation learning rather than reduced-lead reconstruction.

\subsection{Evaluation Methodology and Gaps}
Recent frameworks such as ECGGenEval~\cite{ref63} and multi-center benchmarks~\cite{ref64} emphasize evaluation at signal, feature, and diagnostic levels, and highlight domain shift between centers. Presacan et al.~\cite{ref57} showed that models with high aggregate correlation can still exhibit regression-to-mean behaviour, raising concerns about individual-level fidelity.

A systematic review~\cite{ref65} concluded that three carefully chosen leads can capture more than 99\% of ECG information content (in an information-theoretic sense), but that no universal configuration or algorithm has emerged. Many studies rely on record-wise splits, which can inflate results by leaking patient identity information~\cite{ref9}. We build on this literature by enforcing patient-wise splits, integrating deterministic limb lead computation, and explicitly analysing the role of inter-lead correlations.

%% ============================================================================%%
%% METHODOLOGY
%% ============================================================================

\section{Methodology}
\subsection{Problem Formulation}
Let $x \in \mathbb{R}^{3 \times T}$ denote three measured leads (I, II, V4) and $y \in \mathbb{R}^{5 \times T}$ the five target chest leads (V1, V2, V3, V5, V6), with $T$ samples per lead. We first compute the remaining limb leads using Equations~\ref{eq:einthoven}--\ref{eq:avf}, then train a neural network $f_\theta$ to approximate $y = f_\theta(x)$ in a supervised regression setting. The goal is to preserve both waveform morphology and clinically relevant features.

\subsection{Hybrid Architecture}
The physics module implements Einthoven's law and Goldberger's equations, yielding exact values for III, aVR, aVL, and aVF given I and II. The learnable module is a 1D U-Net adapted for ECG:

\begin{itemize}
    \item Encoder: stacked Conv1D--BatchNorm--ReLU blocks with MaxPool1D downsampling and increasing channel widths (64 $\rightarrow$ 128 $\rightarrow$ 256 $\rightarrow$ 512).
    \item Bottleneck: Conv1D block at the deepest resolution, capturing multi-beat context.
    \item Decoder: ConvTranspose1D upsampling with skip connections from encoder layers and symmetric channel reduction back to 5 output channels.
\end{itemize}

\begin{table}[h]
\caption{Model specifications}
\label{tab:model_specs}
\begin{tabular}{ll}
\toprule
Parameter & Value \\ \midrule
Input channels & 3 (I, II, V4) \\
Output channels & 5 (V1, V2, V3, V5, V6) \\
Base features & 64 \\
Depth & 4 levels \\
Kernel size & 3 \\
Dropout & 0.2 \\
\bottomrule
\end{tabular}
\end{table}

We consider three variants: a baseline shared encoder-decoder, a hybrid model with light per-lead heads on top of the shared trunk, and a physics-aware model with an additional physics loss term.

\begin{table}[h]
\caption{Model variants}
\label{tab:variants}
\small
\begin{tabular}{lp{2.1cm}rr}
\toprule
Variant & Architecture & Params & Overhead \\ \midrule
Baseline & Shared encoder + decoder & 17.1M & --- \\
Hybrid & Shared trunk + 5 heads & 17.1M & +0.06\% \\
Lead-Spec & Shared encoder + 5 decoders & 40.8M & +138\% \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Training Configuration}
All variants are trained under a fixed configuration to enable fair comparison.

\begin{table}[h]
\caption{Training hyperparameters}
\label{tab:training}
\begin{tabular}{ll}
\toprule
Hyperparameter & Value \\ \midrule
Optimizer & AdamW \\
Learning rate & $3\times10^{-4}$ \\
Batch size & 64 \\
Max epochs & 150 \\
Early stopping & Patience 20 epochs \\
Loss & MSE (+ physics term if used) \\
Weight decay & $1\times10^{-4}$ \\
Random seed & 42 \\
\bottomrule
\end{tabular}
\end{table}

For the physics-aware variant, we add
\begin{equation}
    \mathcal{L}_{\text{total}} = \mathcal{L}_{\text{recon}} + \lambda\,\mathcal{L}_{\text{physics}},
\end{equation}
where $\mathcal{L}_{\text{recon}}$ is MSE on chest leads and $\mathcal{L}_{\text{physics}}$ penalizes violations of Einthoven's and Goldberger's laws in denormalized space. We use $\lambda = 0.1$.

For selected comparisons, we use paired tests (paired $t$, Wilcoxon, permutation), bootstrap confidence intervals, and Cohen's $d$ to quantify effect sizes, correcting for multiple testing with Benjamini--Hochberg FDR where appropriate. We report these only where they materially affect interpretation.

%% ============================================================================%%
%% DATASET
%% ============================================================================

\section{Dataset}
\subsection{PTB-XL}
We use PTB-XL~\cite{ref56}, a large ECG dataset from PhysioNet.

\begin{table}[h]
\caption{PTB-XL statistics}
\label{tab:dataset}
\begin{tabular}{ll}
\toprule
Attribute & Value \\ \midrule
Records & 21,837 \\
Patients & 18,885 \\
Duration & 10 s \\
Sampling rate & 500 Hz \\
Samples per lead & 5,000 \\
Leads & 12 \\
Age range & 17--96 years \\
\bottomrule
\end{tabular}
\end{table}

Diagnostic labels are mapped to SNOMED-CT and cover rhythm, morphology, and conduction abnormalities~\cite{ref37}. Table~\ref{tab:snomed} shows representative classes.

\begin{table}[h]
\caption{Representative SNOMED-CT diagnostic classes}
\label{tab:snomed}
\begin{tabular}{lll}
\toprule
Code & Meaning & Example use \\ \midrule
SR & Sinus rhythm & Normal reference \\
MI & Myocardial infarction & Ischemia detection \\
AF & Atrial fibrillation & Rhythm disorder \\
LVH & Left ventricular hypertrophy & Voltage criteria \\
RBBB & Right bundle branch block & Conduction delay \\
LBBB & Left bundle branch block & Conduction delay \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Preprocessing and Splits}
We apply percentile-based clipping (2.5th--97.5th) per lead to remove obvious artifacts~\cite{ref23}, followed by per-lead $z$-score normalization.

Because multiple recordings from the same patient are correlated, record-wise splitting would leak patient identity and inflate performance~\cite{ref9}. We therefore perform patient-wise splits with a 70/15/15 train/validation/test ratio, stratified by diagnostic class where possible.

\begin{table}[h]
\caption{Data splits (patient-wise)}
\label{tab:splits}
\begin{tabular}{lccc}
\toprule
Split & Records & Patients & Purpose \\ \midrule
Train & $\sim$15,286 & $\sim$13,220 & Model training \\
Validation & $\sim$3,276 & $\sim$2,833 & Model selection \\
Test & $\sim$3,275 & $\sim$2,832 & Final evaluation \\
\bottomrule
\end{tabular}
\end{table}

Figure~\ref{fig:ground_truth_corr} shows the inter-lead correlation matrix; notably, V4 correlates strongly with V3 and V5 and more weakly with V1 and V2.

\begin{figure*}[t]
\centering
\maybeincludegraphics[width=0.6\textwidth]{figures/ground_truth_correlations.png}
\Description{Heatmap of inter-lead Pearson correlations computed on PTB-XL; values indicate morphological similarity between leads.}
\caption{Ground-truth inter-lead correlation matrix (PTB-XL). V4 is most correlated with adjacent leads V3 and V5, and less with V1/V2.}
\label{fig:ground_truth_corr}
\end{figure*}

%% ============================================================================%%
%% EVALUATION
%% ============================================================================

\section{Evaluation Methodology}
\subsection{Signal-Level Metrics}
We measure signal fidelity using:

\begin{itemize}
    \item Mean absolute error (MAE) in mV.
    \item Pearson correlation coefficient $r$ to capture morphological similarity.
    \item Signal-to-noise ratio (SNR) in dB:
    \[
    \text{SNR} = 10 \log_{10} \frac{\sum_i y_i^2}{\sum_i (y_i - \hat{y}_i)^2}.
    \]
\end{itemize}

Target values (for chest leads) are MAE $< 0.05$ mV, $r > 0.90$, and SNR $> 20$ dB~\cite{ref41} where possible.

\subsection{Feature-Level Metrics}
We extract clinically relevant features using standard ECG processing pipelines:

\begin{itemize}
    \item QRS duration (Q onset to S offset).
    \item PR interval (P onset to QRS onset).
    \item QT interval (QRS onset to T end).
    \item Heart rate (R--R interval).
\end{itemize}

We compute MAE between features derived from ground-truth and reconstructed signals and compare them to typical clinical tolerances (QRS $< 10$ ms, PR $< 20$ ms, QT $< 30$ ms, HR $< 5$ bpm).

\subsection{Diagnostic Utility}
To assess diagnostic impact, we train a classifier on original ECGs and evaluate it on both original and reconstructed inputs without further fine-tuning. We consider:

\begin{itemize}
    \item Binary MI vs. non-MI classification.
    \item Multi-label classification for MI, AF, LBBB, RBBB, and LVH.
\end{itemize}

We report AUROC and focus on the change $\Delta\text{AUROC} = \text{AUROC}_{\text{recon}} - \text{AUROC}_{\text{orig}}$. A degradation within $0.05$ is treated as acceptable for non-inferiority in this project context.

%% ============================================================================%%
%% RESULTS
%% ============================================================================

\section{Results}
We report single-run results on the held-out test set (approximately 1{,}900 patients). Unless otherwise stated, metrics refer to the baseline shared U-Net.

\subsection{Signal Fidelity Across Variants}
Table~\ref{tab:overall_results} summarizes aggregate performance across the five reconstructed chest leads for the three model variants.

\begin{table}[h]
\caption{Test-set performance across model variants (single run, seed 2024)}
\label{tab:overall_results}
\begin{tabular}{lccc}
\toprule
Variant & $r$ & MAE (mV) & SNR (dB) \\ \midrule
Baseline & 0.9370 & 0.01209 & 63.04 \\
Hybrid & 0.9358 & 0.01228 & 63.00 \\
Physics-aware & 0.9360 & 0.01217 & 63.02 \\
\bottomrule
\end{tabular}
\end{table}

Differences between variants are small ($\Delta r < 0.002$, $\Delta$MAE $< 2\times 10^{-4}$), so architectural changes and the physics-aware loss do not materially change overall chest-lead fidelity. Limb leads III, aVR, aVL, and aVF are obtained deterministically from I and II and are therefore exact by construction; we focus on the learned chest leads.

\subsection{Per-Lead Chest Performance}
Table~\ref{tab:dl_results} reports per-lead metrics for the five reconstructed chest leads under the baseline model.

\begin{table}[h]
\caption{Per-lead reconstruction performance (baseline, single run)}
\label{tab:dl_results}
\begin{tabular}{lcccc}
\toprule
Lead & $r$ & MAE (mV) & SNR (dB) & Rank \\ \midrule
V1 & 0.818 & 0.030 & 19.52 & Hardest \\
V2 & 0.827 & 0.030 & 19.34 & 4th \\
V3 & 0.860 & 0.027 & 20.01 & 2nd \\
V5 & 0.891 & 0.026 & 20.30 & Best \\
V6 & 0.836 & 0.033 & 18.28 & 3rd \\ \midrule
Mean & 0.846 & 0.029 & 19.49 & --- \\
\bottomrule
\end{tabular}
\end{table}

Performance follows the anatomical layout: V5 and V3, which are adjacent to input lead V4, achieve the highest correlations, whereas V1 and V2, which sample right ventricular and septal activity farther from V4, are consistently harder to reconstruct. This mirrors the ground-truth inter-lead correlations in Figure~\ref{fig:ground_truth_corr}.

\begin{figure*}[t]
\centering
\maybeincludegraphics[width=0.6\textwidth]{figures/training_curves.png}
\Description{Training and validation loss/metric curves for the baseline model across epochs.}
\caption{Training convergence for the baseline model (single-run).}
\label{fig:training_curves}
\end{figure*}

\subsection{Decoder Ablation}
To test whether per-lead specialization is beneficial, we compared the shared decoder to a lead-specific decoder that branches into five independent decoders after the shared encoder. Table~\ref{tab:ablation_detail} shows per-lead correlations for this ablation.

\begin{table}[h]
\caption{Shared vs. lead-specific decoders (earlier ablation run)}
\label{tab:ablation_detail}
\begin{tabular}{lccc}
\toprule
Lead & Shared $r$ & Lead-spec $r$ & Better \\ \midrule
V1 & 0.726 & 0.708 & Shared \\
V2 & 0.683 & 0.636 & Shared \\
V3 & 0.765 & 0.728 & Shared \\
V5 & 0.824 & 0.726 & Shared \\
V6 & 0.723 & 0.736 & Lead-spec \\ \midrule
Mean & 0.744 & 0.707 & Shared \\
\bottomrule
\end{tabular}
\end{table}

Although the lead-specific model uses 2.4$\times$ more parameters (40.8M vs.\ 17.1M), it underperforms the shared decoder on four of five leads and lowers mean correlation by about 0.04. Given only three input leads, the shared decoder appears to benefit from parameter sharing and provides better generalization than a heavier, fully specialized decoder.

\subsection{Feature-Level Preservation}
We assess preservation of clinically relevant features derived from reconstructed signals. Table~\ref{tab:clinical_features} reports mean absolute errors together with typical clinical tolerances.

\begin{table}[h]
\caption{Clinical feature preservation (test set)}
\label{tab:clinical_features}
\begin{tabular}{lccc}
\toprule
Feature & MAE & Threshold \\ \midrule
QRS duration & 6.8 ms & $<10$ \\
PR interval & 9.3 ms & $<20$ ms & \\
QT interval & 18.7 ms & $<30$ ms &  \\
Heart rate & 1.9 bpm & $<5$ bpm &  \\ \midrule
P-wave amplitude corr. & \multicolumn{2}{c}{$r = 0.78$} & \\
T-wave amplitude corr. & \multicolumn{2}{c}{$r = 0.84$} & \\
\bottomrule
\end{tabular}
\end{table}

QRS and PR intervals are preserved with comfortable margins. QT interval errors are larger but remain below 30 ms on average, and heart-rate estimation is accurate to within roughly 2 bpm. P- and T-wave correlations indicate that gross morphology is retained, with P-waves more affected due to their lower amplitude. Bland--Altman plots for QRS and QT (Figure~\ref{fig:clinical_features_multiplane}) show small bias and narrow limits of agreement for QRS, and wider limits with occasional outliers for QT.

\begin{figure*}[t]
\centering
\begin{subfigure}[b]{0.33\textwidth}
    \centering
    \maybeincludegraphics[width=\linewidth]{figures/bland_altman_qrs_duration.png}
    \Description{Bland-Altman plot for QRS duration comparing ground truth and reconstructed leads.}
    \caption{QRS Duration Bland--Altman}
    \label{fig:ba_qrs}
\end{subfigure}%
\hfill
\begin{subfigure}[b]{0.33\textwidth}
    \centering
    \maybeincludegraphics[width=\linewidth]{figures/clinical_features_bland_altman_qt_interval.png}
    \Description{Bland-Altman plot for QT interval comparing ground truth and reconstructed leads.}
    \caption{QT Interval Bland--Altman}
    \label{fig:ba_qt}
\end{subfigure}%
\hfill
\begin{subfigure}[b]{0.33\textwidth}
    \centering
    \maybeincludegraphics[width=\linewidth]{figures/clinical_features_mae_heatmap.png}
    \Description{Heatmap of mean absolute error (MAE) per lead for clinically-relevant metrics QRS/PR/QT/HR.}
    \caption{Mean absolute error heatmap}
    \label{fig:mae_heatmap}
\end{subfigure}
\caption{Multiplane clinical feature evaluation: (a) QRS duration Bland--Altman, (b) QT interval Bland--Altman, (c) mean absolute error (MAE) heatmap.}
\label{fig:clinical_features_multiplane}
\end{figure*}

\subsection{Diagnostic Performance and Qualitative Reconstructions}
Using a 12-lead classifier trained on ground-truth ECGs, evaluation on reconstructed signals yields AUROC reductions of approximately 0.03--0.05 for common labels such as MI, AF, and bundle branch blocks. These changes are modest and generally not statistically significant under paired bootstrap with multiple-testing correction. For rarer labels, estimates are more variable and are treated as exploratory.

\begin{figure*}[t]
\centering
\maybeincludegraphics[width=1.0\textwidth]{figures/diag_stats_12_2hr/diagnostic_auroc_heatmap.png}
\Description{Per-label AUROC heatmap comparing classifier on true and reconstructed signals across variants.}
\caption{Per-label AUROC (2-hour trained classifier) across variants: classifier on true signals and reconstructed variants.}
\label{fig:diag_heatmap}
\end{figure*}

% Replace top-k figure with a tabular summary for better readability in print
\input{figures/diag_stats_12_2hr_top_table.tex}

Figure~\ref{fig:reconstruction} shows a representative reconstructed ECG. Deterministic limb leads overlap the ground truth, while reconstructed chest leads preserve QRS polarity and overall morphology with visible but modest amplitude differences, particularly in V1 and V2.

\begin{figure*}[t]
\centering
\maybeincludegraphics[width=0.8\textwidth]{figures/reconstruction_sample_1.png}
\Description{Sample ECG reconstruction showing ground truth (blue) overlaid with reconstructed signals (red).}
\caption{Sample ECG reconstruction. Blue: Ground truth. Red: Reconstructed. Deterministic leads overlap exactly; learned chest leads preserve morphology with minor amplitude differences.}
\label{fig:reconstruction}
\end{figure*}


%% ============================================================================%%
%% DISCUSSION
%% ============================================================================

\section{Discussion}
\subsection{Where the Bottleneck Lies}
Our experiments point consistently to an information bottleneck rather than a modeling bottleneck. Every architecture that receives the same three input leads converges to very similar performance, and adding physics constraints to the loss does not help because those constraints involve only limb leads that are already exactly determined by I and II.

Table~\ref{tab:ground_truth_corr_results} relates reconstruction performance to ground-truth correlations with V4.

\begin{table*}[ht]
\caption{Correlation with input V4 and reconstruction difficulty}
\label{tab:ground_truth_corr_results}
\centering
\small
\begin{tabularx}{\textwidth}{l c c >{\raggedright\arraybackslash}X}
\toprule
Lead & Corr(V4) & Recon $r$ & Comment \\ \midrule
V5 & 0.79 & 0.891 & Adjacent to V4 \\
V3 & 0.71 & 0.860 & Anterior, near V4 \\
V6 & 0.69 & 0.836 & Lateral, close to V5 \\
V1 & 0.49 & 0.818 & Right ventricle \\
V2 & 0.36 & 0.827 & Septal, farther from V4 \\
\bottomrule
\end{tabularx}
\end{table*}

The rank order matches closely: leads that are more correlated with V4 are easier to reconstruct. There is no realistic architecture that can reconstruct V1/V2 as accurately as V5/V3 from the same inputs; the missing information simply is not present. The most promising path forward is therefore to optimize which leads are measured (e.g., I, II, V1 or I, II, V2) rather than to further complicate the model.

\subsection{Shared vs. Lead-Specific Decoders}
The decoder ablation highlights a practical lesson: under limited input information, parameter sharing can be more effective than specialization. The shared decoder aggregates gradients from all five targets, implicitly regularizing the mapping, while the lead-specific decoders overfit more easily. This is reflected in larger train--validation gaps and lower test correlations for the heavier model.

From a deployment perspective, the shared decoder is also simpler to implement and maintain, and it uses fewer parameters and resources, which is important for on-device or near-patient inference.

\subsection{Clinical Interpretation}
At the feature level, QRS and PR intervals are well preserved, suggesting that conduction-related diagnoses (e.g., bundle branch block detection, basic rhythm analysis) can be reasonably supported using reconstructed ECGs, at least as a screening or triage step. QT-related metrics and subtle morphology changes in low-amplitude waves (P, terminal T) are more fragile; they demand higher fidelity and may require either additional measured leads or uncertainty-aware reporting.

The diagnostic AUROC analysis reinforces this picture: common labels show modest degradation, while rare labels and nuanced patterns are less stable. For this project, it is more meaningful to treat reconstructed ECGs as augmenting low-lead devices for monitoring and triage than as a drop-in replacement for full 12-lead recordings in high-stakes decision making.

\subsection{Comparison to Prior Work}
Our mean chest lead correlation ($r \approx 0.846$) is slightly lower than the best numbers reported in some deep-learning studies ($r \approx 0.90$), but most of those works use record-wise splits and sometimes different input configurations, both of which can favour higher reported performance~\cite{ref9,ref61,ref64}. Given our stricter patient-wise protocol and the challenging (I, II, V4) configuration for V1/V2, the results are competitive and arguably more realistic.

%% ============================================================================%%
%% LIMITATIONS AND FUTURE WORK
%% ============================================================================

\section{Limitations and Future Work}
Our study has several limitations. First, evaluation is limited to PTB-XL; external validation on datasets such as Chapman-Shaoxing, MIMIC-IV-ECG, or UK Biobank is needed to assess robustness to different populations and acquisition setups. Second, we report single-run results due to project time constraints; a full multi-seed analysis with bootstrap confidence intervals would provide tighter uncertainty estimates. Third, we did not systematically explore all possible input configurations; preliminary evidence suggests that including a right-sided or septal chest lead (V1 or V2) would materially improve reconstruction of those regions.

Future work should therefore (i) optimize input lead selection using both anatomical reasoning and information-theoretic criteria, (ii) perform multi-dataset, multi-seed benchmarking under unified evaluation protocols, (iii) integrate uncertainty quantification for downstream clinical use, and (iv) explore leveraging pre-trained ECG foundation models as encoders in the hybrid architecture.

%% ============================================================================%%
%% CONCLUSION
%% ============================================================================

\section{Conclusion}
We investigated a hybrid physics-informed deep learning approach for reconstructing 12-lead ECGs from three measured leads (I, II, V4). Deterministic equations provide exact limb leads, while a 1D U-Net reconstructs five chest leads. On PTB-XL with patient-wise splits, the model achieves mean chest lead correlation $r \approx 0.846$ with clinically acceptable preservation of key intervals and modest degradation in diagnostic AUROC.

Three conclusions follow. First, performance is primarily constrained by inter-lead correlations and anatomical proximity between measured and target leads; architecture changes that do not alter inputs have limited effect. Second, a parameter-efficient shared decoder outperforms a heavier lead-specific decoder, illustrating the value of parameter sharing when information is limited. Third, reconstructed ECGs appear suitable for screening, monitoring, and retrospective analysis, but not yet for standalone diagnosis in high-risk scenarios such as acute coronary syndromes.

Overall, our results support the feasibility of hybrid physics-informed and deep learning methods for reduced-lead ECG systems and underline the importance of input lead selection as a central design decision.

%% ============================================================================%%
%% ACKNOWLEDGMENTS
%% ============================================================================

\begin{acks}
We thank Dr. Ahmed El-Roby at Carleton University for his guidance throughout this project. We also acknowledge PhysioNet for providing open access to the PTB-XL dataset.
\end{acks}

%% ============================================================================%%
%% REFERENCES
%% ============================================================================

\bibliographystyle{ACM-Reference-Format}
\bibliography{references}

%% ============================================================================%%
%% APPENDIX
%% ============================================================================

\appendix

\section*{Appendix: Input Configuration Exploration}
\label{sec:input}
Motivated by the observed information bottleneck, a natural extension is to compare alternative input configurations that include different precordial leads. Table~\ref{tab:configs} lists configurations we plan to evaluate beyond this project.

\begin{table}[h]
\caption{Candidate input lead configurations for future work}
\label{tab:configs}
\begin{tabular}{lll}
\toprule
Config & Input leads & Rationale \\ \midrule
Primary & I, II, V4 & Central chest position \\
Alt.~1 & I, II, V3 & Higher overlap with V2/V4 \\
Alt.~2 & I, II, V2 & Better septal coverage \\
Alt.~3 & I, II, V2+V4 & Two chest leads (4-lead) \\
\bottomrule
\end{tabular}
\end{table}

\end{document}
